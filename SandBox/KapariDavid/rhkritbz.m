function RHBZ=rhkritbz(q,s)
w=1; %q=0.008

poly=[-q q 2];
xv=roots(poly);
for i=1:2
    if real(xv(i))>0 && imag(xv(i))==0;
        x=xv(i);
    end
end 
%x=-(r*(1+n))/(3*r)-(2^(1/3)*(-(r*(1+n))^2 + 3*r*(f-1+r*n)))/(3*r*(-2*(r*(1+n))^3 + 9*r*(r*(1+n))*(f-1+r*n) - 27*r^2*(-n*(f+1)) + sqrt(4*(-(r*(1+n))^2 + 3*r*(f-1+r*n))^3 + (-2*(r*(1+n))^3 + 9*r*(r*(1+n))*(f-1+r*n) - 27*r^2*(-n*(f+1)))^2))^(1/3)) + (-2*(r*(1+n))^3 + 9*r*(r*(1+n))*(f-1+r*n) - 27*r^2*(-n*(f+1)) + sqrt(4*(-(r*(1+n))^2 + 3*r*(f-1+r*n))^3 + (-2*(r*(1+n))^3 + 9*r*(r*(1+n))*(f-1+r*n) - 27*r^2*(-n*(f+1)))^2))^(1/3)/(3*2^(1/3)*r);
x;
y=x/(x+1);
z=x;

J=[s*(-y+1-2*q*x) s*(1-x) 0; -y/s -1*(x+1)/s 1/s; w 0 -w];

a=charpoly(J);

RHBZ=a(2)*a(3)-a(4);